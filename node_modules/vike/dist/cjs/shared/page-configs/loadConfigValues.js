"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadConfigValues = void 0;
const utils_js_1 = require("../utils.js");
const parseConfigValuesImported_js_1 = require("./serialize/parseConfigValuesImported.js");
const parseConfigValuesSerialized_js_1 = require("./serialize/parseConfigValuesSerialized.js");
async function loadConfigValues(pageConfig, isDev) {
    if ('isAllLoaded' in pageConfig &&
        // We don't need to cache in dev, since Vite already caches the virtual module
        !isDev) {
        return pageConfig;
    }
    const configValuesLoaded = await pageConfig.loadConfigValuesAll();
    {
        const { configValuesImported } = configValuesLoaded;
        const configValuesAddendum = (0, parseConfigValuesImported_js_1.parseConfigValuesImported)(configValuesImported);
        Object.assign(pageConfig.configValues, configValuesAddendum);
    }
    {
        const { configValuesSerialized } = configValuesLoaded;
        const configValuesAddendum = (0, parseConfigValuesSerialized_js_1.parseConfigValuesSerialized)(configValuesSerialized);
        Object.assign(pageConfig.configValues, configValuesAddendum);
    }
    (0, utils_js_1.objectAssign)(pageConfig, { isAllLoaded: true });
    return pageConfig;
}
exports.loadConfigValues = loadConfigValues;
